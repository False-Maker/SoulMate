## 目标
- 女性用户：首次进入数字人直接加载“男性数字人”，不再先显示女性再切换。
- 数字人↔会话来回切换：不再不断 push 新页面实例，避免第三次进入加载失败。

## 具体改动 1：修复首帧性别为 UNSET 导致错绑
- 修改 [ChatViewModel.kt](file:///d:/Demo/SoulMate/app/src/main/java/com/soulmate/ui/viewmodel/ChatViewModel.kt)
  - 现状：`userGenderFlow.stateIn(..., initialValue = UNSET)` 会让 UI 首帧先拿到 UNSET。
  - 修复：把 `val userGender` 改为直接暴露仓库的 `userGenderFlow`（它本身就是 StateFlow，初始值来自 prefs），不要再 `stateIn(..., UNSET)`。
  - 结果：`DigitalHumanScreen` 首次 collect 到的就是 prefs 的真实性别（除非真的没选过）。

## 具体改动 2：让 UNSET 时不绑定 SDK（兜底防抖）
- 修改 [DigitalHumanScreen.kt](file:///d:/Demo/SoulMate/app/src/main/java/com/soulmate/ui/screens/DigitalHumanScreen.kt)
  - 现状：`UNSET -> MALE`，会强制先绑“女性数字人”。
  - 修复：
    - 如果 `userGender == UNSET`：显示“正在读取性别/请先完成性别选择”的占位，不创建 `AvatarContainer`。
    - 只有 `MALE/FEMALE` 时才创建 `AvatarContainer`。
  - 结果：即使未来某些时序仍短暂出现 UNSET，也不会触发一次错误 init/bind。

## 具体改动 3：修复数字人↔会话反复 navigate 导致栈膨胀
- 修改 [SoulMateApp.kt](file:///d:/Demo/SoulMate/app/src/main/java/com/soulmate/ui/SoulMateApp.kt)
  - 现状：DigitalHuman->Chat 用 `navigate(Chat)`，Chat->DigitalHuman 用 `navigate(DigitalHuman)`，会在 back stack 里不断叠加实例。
  - 修复策略（保持交互直觉：返回回到 Home）：
    - 从 DigitalHuman 去 Chat：`navController.navigate(Screen.Chat.route) { popUpTo(Screen.Home.route) { inclusive = false } launchSingleTop = true }`
    - 从 Chat 去 DigitalHuman：`navController.navigate(Screen.DigitalHuman.route) { popUpTo(Screen.Home.route) { inclusive = false } launchSingleTop = true }`
  - 结果：栈稳定保持 `Home -> Chat` 或 `Home -> DigitalHuman`，不会出现第三次/第 N 次进入越来越不稳定。

## 具体改动 4（可选但推荐）：避免离开页面重复 destroy
- 修改 [AvatarContainer.kt](file:///d:/Demo/SoulMate/app/src/main/java/com/soulmate/ui/components/AvatarContainer.kt)
  - 现状：同一次离开可能同时触发 `Lifecycle ON_DESTROY` 和 `onDispose`，两边都 `destroy()`。
  - 修复：保留 `onDispose` 的 destroy，把 `Lifecycle.Event.ON_DESTROY` 分支移除或改为空（只保留 ON_RESUME/ON_PAUSE）。
  - 结果：减少 destroy/init 交错概率，进一步降低 SDK 初始化失败与缓存异常。

## 验证方式
- 复现路径验证：女性用户→数字人→会话→数字人→会话→数字人，观察头像始终正确且每次都能加载。
- 日志验证：只出现一次 bind（不再出现首帧错绑后的 rebind），且 back stack 不再增长。
- 编译验证：跑 `:app:compileDebugKotlin` 确保无编译错误。